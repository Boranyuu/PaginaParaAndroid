<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calendario de Citas</title>

  <!-- CSS -->
  <link rel="stylesheet" href="./assets/styles.css" />
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/main.min.css" rel="stylesheet" />

  <!-- FullCalendar -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/index.global.min.js"></script>

  <!-- Firebase -->
  <script type="module" src="./js/firebase.js"></script>

  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    .navbar { z-index: 10; display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; background-color: #102d28; color: white; position: fixed; top: 0; width: 100%; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    .logo { font-weight: bold; font-size: 1.2rem; }
    #mainCalendario { margin-top: 80px; width: 100%; height: calc(100vh - 80px); display: flex; justify-content: center; align-items: center; flex-direction: column; }
    #calendar { width: 95%; height: 100%; }
    button { border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; color: white; margin-top: 10px; }
    #btnCrearEvento { background-color: #00796b; }
    #btnCrearActividad { background-color: #ff9800; }

    /* MODALES */
    .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.45); justify-content:center; align-items:center; z-index:9999; }
    .modal-content { background:#fff; padding:18px; border-radius:10px; width:520px; max-width:95%; display:flex; flex-direction:column; position:relative; }
    .modal-content label { margin-top: 8px; font-weight:bold; }
    .modal-content input, .modal-content select, .modal-content textarea { width:100%; padding:6px 10px; margin-top:4px; box-sizing:border-box; }
    .close { position:absolute; top:10px; right:15px; cursor:pointer; font-size:1.2rem; font-weight:bold; }
    .btn { border:none; padding:8px 12px; border-radius:5px; cursor:pointer; margin-right:6px; }
    .btn-primary { background-color:#00796b; color:white; }
    .btn-danger { background-color:#c62828; color:white; }
    .btn-info { background-color:#0277bd; color:white; }
    .modal-row { display:flex; gap:8px; align-items:center; }
  </style>
</head>

<body id="calendar-page">
  <nav class="navbar">
    <div class="logo">Calendario de Citas</div>
    <div id="CerrarSesion" class="nav-right">
      <span id="nombreUsuario"></span>
      <button id="btnCerrarSesion">Cerrar Sesión</button>
    </div>
  </nav>

  <div id="mainCalendario">
    <div id="calendar"></div>
    <button id="btnCrearEvento">Crear Nueva Cita</button>
    <button id="btnCrearActividad">Crear Nueva Actividad</button>
  </div>

  <!-- MODAL CITA -->
  <div id="modalCita" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close">&times;</span>
      <h2 id="modalTitulo">Crear Cita</h2>
      <input type="hidden" id="idCitaSeleccionada">

      <label for="actividadSelect">Actividad:</label>
      <select id="actividadSelect" required>
        <option value="">Cargando actividades...</option>
      </select>

      <hr>

      <div id="datosActividad" style="display:none;">
        <h3>Información de la Actividad</h3>
        <p><strong>Nombre:</strong> <span id="actNombre"></span></p>
        <p><strong>Tipo:</strong> <span id="actTipo"></span></p>
        <p><strong>Lugar:</strong> <span id="actLugar"></span></p>
        <p><strong>Oferente:</strong> <span id="actOferente"></span></p>
        <p><strong>Beneficiarios:</strong> <span id="actBeneficiarios"></span></p>
        <p><strong>Duración:</strong> <span id="actDuracion"></span></p>
        <p><strong>Cupo Máximo:</strong> <span id="actCupo"></span></p>
        <hr>
      </div>

      <div class="modal-row">
        <div style="flex:1">
          <label for="fechaCita">Fecha de Cita:</label>
          <input type="date" id="fechaCita" required />
        </div>
        <div style="width:140px">
          <label for="horaCita">Hora de Cita:</label>
          <input type="time" id="horaCita" required />
        </div>
      </div>

      <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:10px;">
        <button id="btnReagendarCita" class="btn btn-info" style="display:none;">Reagendar</button>
        <button id="btnEliminarCita" class="btn btn-danger" style="display:none;">Eliminar</button>
        <button id="btnGuardarCita" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- MODAL ACTIVIDAD -->
  <div id="modalActividad" class="modal">
    <div class="modal-content">
      <span id="closeModalActividad" class="close">&times;</span>
      <h2 id="modalTituloActividad">Crear Actividad</h2>
      <input type="hidden" id="idActividadSeleccionada">

      <label for="nombreActividad">Nombre:</label>
      <input type="text" id="nombreActividad" required />

      <label for="tipoActividad">Tipo:</label>
      <select id="tipoActividad">
        <option value="">Cargando tipos...</option>
      </select>

      <label for="lugarActividad">Lugar:</label>
      <select id="lugarActividad">
        <option value="">Cargando lugares...</option>
      </select>

      <label for="oferenteActividad">Oferente:</label>
      <select id="oferenteActividad">
        <option value="">Cargando oferentes...</option>
      </select>

      <label for="socioActividad">Socio Comunitario:</label>
      <select id="socioActividad">
        <option value="">Cargando socios...</option>
      </select>

      <label for="proyectoActividad">Proyecto:</label>
      <select id="proyectoActividad">
        <option value="">Cargando proyectos...</option>
      </select>

      <label for="beneficiariosActividad">Beneficiarios (separados por coma):</label>
      <input type="text" id="beneficiariosActividad" placeholder="Abuelos,Niños,Discapacitados" />

      <label for="duracionActividad">Duración (min):</label>
      <input type="number" id="duracionActividad" min="0" />

      <label for="cupoActividad">Cupo Máximo:</label>
      <input type="number" id="cupoActividad" min="1" />

      <label for="descripcionActividad">Descripción:</label>
      <textarea id="descripcionActividad"></textarea>

      <div style="display:flex; justify-content:flex-end; margin-top:10px;">
        <button id="btnGuardarActividad" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script type="module" src="./js/actividades.js"></script>
  <script type="module" src="./js/calendario.js"></script>
  <script type="module" src="./js/cita.js"></script>
</body>
</html>
